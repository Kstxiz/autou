name: Continuous Integration (CI) - Lint & Documenta√ß√£o

# üéØ Quando o workflow deve ser executado
on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

# ‚öôÔ∏è Define os jobs (tarefas) a serem executados
jobs:
  # Job 1: Validar Qualidade da Documenta√ß√£o (Markdown)
  lint_markdown:
    name: Lint de Documenta√ß√£o
    runs-on: ubuntu-latest
    
    steps:
      - name: 1. Checkout do C√≥digo
        # Baixa o c√≥digo do seu reposit√≥rio
        uses: actions/checkout@v4
      
      - name: 2. Executar Markdown Linter
        # Usa um Action pronto para checar se o README e outros Markdowns est√£o bem formatados
        uses: avto-dev/markdown-lint@v1
        with:
          args: './*.md' # Checa todos os arquivos .md na raiz
          
  # Job 2: Valida√ß√£o Python/Flask (AGORA COMPLETO)
  validate_python:
    name: Lint de C√≥digo Python (Backend)
    runs-on: ubuntu-latest
    
    steps:
      - name: 1. Checkout do C√≥digo
        uses: actions/checkout@v4

      - name: 2. Configurar Python 3.10
        # Necess√°rio para rodar o c√≥digo e as ferramentas do Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
          
      - name: 3. Instalar Depend√™ncias e Flake8
        # Instala a ferramenta Flake8 para an√°lise est√°tica e as depend√™ncias do Flask
        run: |
          pip install flake8
          # Instala as depend√™ncias listadas em api/requirements.txt
          if [ -f api/requirements.txt ]; then
            pip install -r api/requirements.txt
          fi

      - name: 4. Executar Flake8 (Linter de Python)
        # O Flake8 checa estilo e erros comuns (como vari√°veis n√£o utilizadas ou erros de sintaxe)
        run: |
          # Checa o c√≥digo na pasta 'api/'
          # --select=E9,F63,F7,F82: Foca em erros de sintaxe e bugs.
          # --max-line-length=88: Define o limite de linha, um bom padr√£o para Python.
          flake8 api/ --count --select=E9,F63,F7,F82 --show-source --statistics --max-line-length=88